Code from this blog post https://www.well-typed.com/blog/2015/11/implementing-a-minimal-version-of-haskell-servant/.
